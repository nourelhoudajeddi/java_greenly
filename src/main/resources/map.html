<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Map</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <style>
        html, body {
            height: 100%;
            margin: 0;
        }

        #map {
            height: 100vh; /* Remplacer height: 100% par une hauteur explicite */
            width: 100%;
            cursor: pointer; /* Le curseur devient une main pour signaler que l'on peut cliquer */
        }
    </style>
    <script type="text/javascript">
        var map;
        var marker;

        function initMap() {
            map = L.map('map').setView([33.8869, 9.5375], 6);  // Initialisation de la carte centrée sur la Tunisie

            // Chargement des tuiles OpenStreetMap
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; OpenStreetMap contributors'
            }).addTo(map);

            // Événement de clic sur la carte pour récupérer les coordonnées
            map.on('click', function(e) {
                var lat = e.latlng.lat;
                var lon = e.latlng.lng;

                // Affichage dans la console pour vérifier que les coordonnées sont récupérées
                console.log("Latitude: " + lat + ", Longitude: " + lon);

                if (marker) {
                    map.removeLayer(marker);
                }

                marker = L.marker([lat, lon]).addTo(map);

                if (window.javaCallback) {
                    window.javaCallback.getCoordinates(lat, lon);
                }
            });
        }

        // Appeler initMap après le chargement de la page
        window.onload = initMap;
    </script>
</head>
<body>
<div id="map"></div>
</body>
</html>
